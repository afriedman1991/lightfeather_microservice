const axios = require('axios');

class SupervisorsService {
	async GetSupervisors(request, resp) {
		return await axios.get('https://o3m5qixdng.execute-api.us-east-1.amazonaws.com/api/managers')
		.then(data => {
			return data.data;
		})
		.catch(err => console.error(`Get request to supervisors database failed: ${err}`));
	}

	async PostNotificationData(notificationData) {
		let missingRequiredFields = {fields: [], err: null};

		if (notificationData.firstName === '' || notificationData.firstName === null || notificationData.firstName === undefined) {
			missingRequiredFields.fields.push('firstName');
		}

		if (notificationData.lastName === '' || notificationData.lastName === null || notificationData.lastName === undefined) {
			missingRequiredFields.fields.push('lastName');
		}

		if (notificationData.supervisor === '' || notificationData.supervisor === null || notificationData.supervisor === undefined) {
			missingRequiredFields.fields.push('supervisor');
		}
		
		if (missingRequiredFields.fields.length > 0) {
			const errorMessage = `Missing the following required fields to complete this request: ${[...missingRequiredFields.fields]}`;
			missingRequiredFields.err = errorMessage;
			return missingRequiredFields;
		} else {
			return notificationData;
		}
	}
}

module.exports = SupervisorsService;
